<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}College Management System{% endblock %}</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Ultra Modern Light Theme CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/ultra-light.css') }}">
    
    {% block extra_css %}{% endblock %}
</head>
<body class="{% if current_user.is_authenticated %}{{ current_user.role }}-theme{% endif %}">
    
    {% if current_user.is_authenticated %}
    <!-- Ultra Modern Navigation -->
    <nav class="navbar-ultra">
        <div class="container-fluid px-4">
            <div class="d-flex justify-content-between align-items-center w-100">
                <a class="navbar-brand-ultra" href="{{ url_for('index') }}">
                    <i class="fas fa-graduation-cap"></i>
                    College Management
                </a>
                
                <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="d-flex align-items-center">
                    <ul class="nav-ultra mobile-hidden" id="mainNav">
                        {% if current_user.role == 'student' %}
                            <li class="nav-item-ultra">
                                <a class="nav-link-ultra {{ 'active' if request.endpoint == 'student_dashboard' }}" href="{{ url_for('student_dashboard') }}">
                                    <i class="fas fa-chart-line"></i>Dashboard
                                </a>
                            </li>
                            <li class="nav-item-ultra">
                                <a class="nav-link-ultra {{ 'active' if request.endpoint == 'student_profile' }}" href="{{ url_for('student_profile') }}">
                                    <i class="fas fa-user"></i>Profile
                                </a>
                            </li>
                            <li class="nav-item-ultra">
                                <a class="nav-link-ultra {{ 'active' if request.endpoint == 'student_attendance' }}" href="{{ url_for('student_attendance') }}">
                                    <i class="fas fa-calendar-check"></i>Attendance
                                </a>
                            </li>
                            <li class="nav-item-ultra">
                                <a class="nav-link-ultra {{ 'active' if request.endpoint == 'student_feedback' }}" href="{{ url_for('student_feedback') }}">
                                    <i class="fas fa-comment"></i>Feedback
                                </a>
                            </li>
                        {% elif current_user.role == 'faculty' %}
                            <li class="nav-item-ultra">
                                <a class="nav-link-ultra {{ 'active' if request.endpoint == 'faculty_dashboard' }}" href="{{ url_for('faculty_dashboard') }}">
                                    <i class="fas fa-chart-line"></i>Dashboard
                                </a>
                            </li>
                            <li class="nav-item-ultra">
                                <a class="nav-link-ultra {{ 'active' if request.endpoint == 'faculty_attendance' }}" href="{{ url_for('faculty_attendance') }}">
                                    <i class="fas fa-calendar-check"></i>Attendance
                                </a>
                            </li>
                        {% elif current_user.role == 'admin' %}
                            <li class="nav-item-ultra">
                                <a class="nav-link-ultra {{ 'active' if request.endpoint == 'admin_dashboard' }}" href="{{ url_for('admin_dashboard') }}">
                                    <i class="fas fa-chart-line"></i>Dashboard
                                </a>
                            </li>
                            <li class="nav-item-ultra dropdown-ultra" onclick="toggleMobileDropdown(this)">
                                <a class="nav-link-ultra" href="#" onclick="event.preventDefault();">
                                    <i class="fas fa-cogs"></i>Management
                                    <i class="fas fa-chevron-down ms-1"></i>
                                </a>
                                <div class="dropdown-menu-ultra">
                                    <a class="dropdown-item-ultra" href="{{ url_for('admin_users') }}">
                                        <i class="fas fa-users"></i>
                                        User Management
                                    </a>
                                    <a class="dropdown-item-ultra" href="{{ url_for('admin_classrooms') }}">
                                        <i class="fas fa-school"></i>
                                        Classrooms
                                    </a>
                                    <a class="dropdown-item-ultra" href="{{ url_for('admin_courses') }}">
                                        <i class="fas fa-book"></i>
                                        Courses
                                    </a>
                                    <a class="dropdown-item-ultra" href="{{ url_for('admin_departments') }}">
                                        <i class="fas fa-university"></i>
                                        Departments
                                    </a>
                                </div>
                            </li>
                            <li class="nav-item-ultra dropdown-ultra">
                                <a class="nav-link-ultra" href="#">
                                    <i class="fas fa-bullhorn"></i>Communication
                                    <i class="fas fa-chevron-down ms-1"></i>
                                </a>
                                <div class="dropdown-menu-ultra">
                                    <a class="dropdown-item-ultra" href="{{ url_for('admin_announcements') }}">
                                        <i class="fas fa-bullhorn"></i>
                                        Announcements
                                    </a>
                                    <a class="dropdown-item-ultra" href="{{ url_for('admin_enquiries') }}">
                                        <i class="fas fa-question-circle"></i>
                                        Enquiries
                                    </a>
                                    <a class="dropdown-item-ultra" href="{{ url_for('admin_notifications') }}">
                                        <i class="fas fa-bell"></i>
                                        Notifications
                                    </a>
                                </div>
                            </li>
                        {% endif %}
                    </ul>
                    
                    <div class="user-menu-ultra">
                        <div class="dropdown-ultra">
                            <div class="d-flex align-items-center nav-link-ultra" style="cursor: pointer;">
                                <div class="user-avatar-ultra me-2">
                                    {{ current_user.get_full_name()[:1].upper() }}
                                </div>
                                <span style="color: white;">{{ current_user.get_full_name() }}</span>
                                <i class="fas fa-chevron-down ms-2"></i>
                            </div>
                            <div class="dropdown-menu-ultra">
                                {% if current_user.role == 'student' %}
                                    <a class="dropdown-item-ultra" href="{{ url_for('student_profile') }}">
                                        <i class="fas fa-user"></i>
                                        My Profile
                                    </a>
                                {% endif %}
                                <a class="dropdown-item-ultra" href="{{ url_for('logout') }}">
                                    <i class="fas fa-sign-out-alt"></i>
                                    Sign Out
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    {% endif %}
    
    <!-- Ultra Modern Main Content -->
    <main style="{% if not current_user.is_authenticated %}min-height: 100vh; display: flex; align-items: center;{% endif %}">
        <div class="{% if current_user.is_authenticated %}container-fluid{% else %}container-fluid{% endif %}">
            <!-- Ultra Modern Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div style="position: fixed; top: 100px; right: 2rem; z-index: 9999; max-width: 400px;">
                        {% for category, message in messages %}
                            <div class="ultra-card mb-3" style="padding: 1rem; border-left: 4px solid {% if category == 'error' or category == 'danger' %}#ef4444{% elif category == 'success' %}#10b981{% elif category == 'warning' %}#f59e0b{% else %}#6366f1{% endif %};">
                                <div class="d-flex align-items-start">
                                    <div style="width: 24px; height: 24px; border-radius: 50%; background: {% if category == 'error' or category == 'danger' %}rgba(239, 68, 68, 0.1){% elif category == 'success' %}rgba(16, 185, 129, 0.1){% elif category == 'warning' %}rgba(245, 158, 11, 0.1){% else %}rgba(99, 102, 241, 0.1){% endif %}; display: flex; align-items: center; justify-content: center; margin-right: 0.75rem; flex-shrink: 0;">
                                        <i class="fas fa-{% if category == 'error' or category == 'danger' %}exclamation-triangle{% elif category == 'success' %}check{% elif category == 'warning' %}exclamation{% else %}info{% endif %}" style="color: {% if category == 'error' or category == 'danger' %}#ef4444{% elif category == 'success' %}#10b981{% elif category == 'warning' %}#f59e0b{% else %}#6366f1{% endif %}; font-size: 0.75rem;"></i>
                                    </div>
                                    <div class="flex-grow-1">
                                        <div style="color: #1f2937; font-size: 0.9rem; line-height: 1.4;">{{ message }}</div>
                                    </div>
                                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: #6b7280; cursor: pointer; padding: 0; margin-left: 0.5rem;">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}
            
            {% block content %}{% endblock %}
        </div>
    </main>
    
    <!-- Footer -->
    {% if current_user.is_authenticated %}
    <footer class="bg-light text-center py-3 mt-5">
        <div class="container">
            <p class="mb-0 text-muted">
                &copy; 2024 College Management System. All rights reserved.
            </p>
        </div>
    </footer>
    {% endif %}
    
    <!-- Bootstrap 5 JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Ultra Modern JavaScript -->
    <script>
        // Mobile menu toggle
        function toggleMobileMenu() {
            const nav = document.getElementById('mainNav');
            const menuToggle = document.querySelector('.mobile-menu-toggle i');
            
            if (window.innerWidth <= 768) {
                nav.classList.toggle('mobile-active');
                nav.classList.remove('mobile-hidden');
                
                // Toggle hamburger icon
                if (nav.classList.contains('mobile-active')) {
                    menuToggle.className = 'fas fa-times';
                } else {
                    menuToggle.className = 'fas fa-bars';
                }
            }
        }
        
        // Mobile dropdown toggle
        function toggleMobileDropdown(element) {
            if (window.innerWidth <= 768) {
                element.classList.toggle('mobile-expanded');
            }
        }
        
        // Handle responsive navigation
        function handleResize() {
            const nav = document.getElementById('mainNav');
            const menuToggle = document.querySelector('.mobile-menu-toggle i');
            
            if (window.innerWidth > 768) {
                nav.classList.remove('mobile-hidden', 'mobile-active');
                nav.classList.remove('mobile-hidden');
                menuToggle.className = 'fas fa-bars';
                
                // Reset mobile dropdowns
                document.querySelectorAll('.dropdown-ultra').forEach(dropdown => {
                    dropdown.classList.remove('mobile-expanded');
                });
            } else {
                nav.classList.add('mobile-hidden');
                nav.classList.remove('mobile-active');
            }
        }
        
        // Initialize navigation
        document.addEventListener('DOMContentLoaded', function() {
            handleResize();
            window.addEventListener('resize', handleResize);
            
            // Auto-hide flash messages
            const flashMessages = document.querySelectorAll('.ultra-card[style*="position: fixed"]');
            flashMessages.forEach(message => {
                setTimeout(() => {
                    message.style.opacity = '0';
                    message.style.transform = 'translateX(100%)';
                    setTimeout(() => message.remove(), 300);
                }, 5000);
            });
            
            // Smooth animations on scroll
            const cards = document.querySelectorAll('.stat-card-ultra, .quick-action-card, .ultra-card');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            });
            
            cards.forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'all 0.6s ease';
                observer.observe(card);
            });
        });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>
